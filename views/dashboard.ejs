<%- include("partials/header", {title: "Pet dashboard"}); %>

<body class="puppy-paw-background">
  <%- include('partials/nav', {active: "dashboard"}) %>
    <% if (locals.messages.errors) { %>
    <div class="alertdiv" role="alert">
        <% messages.errors.forEach( el=> { %>
            <div class="alert alert-danger">
                <%= el.msg %>
            </div>
            <% }) %>
    </div>
    <% } %>

        <% if (locals.messages.info) { %>
            <div role="alert" class="infodiv">
                <% messages.info.forEach( el=> { %>
                    <div class="alert alert-danger">
                        <%= el.msg %>
                    </div>
                    <% }) %>
            </div>
            <% } %>

  <%- include('partials/modal-pet') %>
  <%- include('partials/modal-pet-delete') %>
  <!--Pet Table-->
  <div class="px-4 py-5 mx-3 text-center">
    <h1 class="text-success mb-5">
      <%= user.userName %>'s Pet Dashboard
    </h1>
    <div class="row mb-5">
      <div class="col-lg-6 mx-auto mb-5">
        <img class="mb-2"
          src="https://www.svgrepo.com/show/163512/pets-hotel-symbol-with-a-dog-and-a-cat-in-a-circle-with-one-star.svg"
          alt="a dog and a cat in a circle" width="50" height="50">
        <h2 class="text-success mb-3">
          <%= user.userName %> has <%= petCount %> pet(s).
        </h2>
        <p class="text-muted">Attention: deleting a pet will also erase all tasks associated with it.</p>
        <div class="table-responsive-md">
          <table class="table table-hover table-sort table-arrows">
            <tr>
              <th>Name</th>
              <th>Breed</th>
              <th>Birthday</th>
              <th>Age</th>
              <th>Edit</th>
              <th>Delete</th>
            </tr>
            <% pets.forEach (el=> { %>
              <tr data-id='<%=el._id%>'>
                <td class="text-primary">
                  <%= el.petName %>
                </td>
                <td>
                  <%= el.petBreed %>
                </td>
                <td>
                  <%= el.petBirthday %>
                </td>
                <td>
                  <%= el.petAge %>
                </td>
                <td class="editpet"><button class="btn btn-success" aria-label="Edit pet" title="Edit pet" data-bs-toggle="modal" data-bs-target="#petEdit-modal" data-id='<%=el._id%>' data-name='<%=el.petName%>' data-breed='<%=el.petBreed%>' data-birthday='<%=el.petBirthday%>' data-age='<%=el.petAge%>'><i
                      class="fa-solid fa-pen-to-square"></i></button></td>
                <td><button class="btn btn-danger" aria-label="Delete pet" title="Delete pet" data-bs-toggle="modal" data-bs-target="#petDelete-modal" data-id="<%=el._id%>" data-name="<%=el.petName%>"><i class="fa-solid fa-trash"></i></button></td>
              </tr>
              <% }) %>
          </table>
        </div>
      </div>

      <!--Pet Form-->
      <%- include("partials/form-pet", {title: "Add a pet", edit: false}); %>
    </div>
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.min.js"
      integrity="sha384-ODmDIVzN+pFdexxHEHFBQH3/9/vQ9uori45z4JjnFsRydbmQbmL5t1tQ0culUzyK"
      crossorigin="anonymous"></script>
    <script src="js/pet.js"></script>
    <script src="js/calendar.js"></script>

</body>

</html>